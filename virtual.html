<!DOCTYPE html>
<html>
<head>
</head>
<style>
body
{
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
}
.box 
{
    padding: 10px
}
#container 
{
    height: 300px;
    overflow: scroll;
}
#result
{
    display: flex; 
    flex-direction: "column"; 
    justify-content: center;
    align-items: center;
}
.inside-box
{
    background-color: aqua;
    height: 100px;
    width: 200px;
    display: flex;
    justify-content: center;
    align-items: center;
}
</style>
<body>
    <div id="container"></div>
    <div id="result">
        <h4>Visible Box are:</h4>
    </div>
</body>
<script>
    const totalNumberOfBox = 100
    const boxHeight = 120
    let containerHeight = document.getElementById('container').clientHeight
    const options = {
            root: document.getElementById('container'),
            rootMargin: '0px',
            threshold: [0]
    }
    let start=0, end=0
    let previousY=containerHeight/2
    let initial=true
    const callback = (entries) => {
        entries.forEach(function(entry) {
            if(!initial){
                if(previousY>entry.boundingClientRect.y){
                console.log("scrolling up")
                // if(start!=1){
                //     start-=1
                //     renderBox()
                // }
                } else {
                console.log("scrolling down")
                // if(start!=totalNumberOfBox-2){
                //     start+=1
                //     renderBox()
                // }
                }
            }
            initial=false
            previousY=entry.boundingClientRect.y
        });
    }
    var observer = new IntersectionObserver(callback, options);
    let addObserver = (id) => {
        initial=true
        console.log(id)
        let observedNode=document.querySelector('[id="'+id+'"]');
        observer.observe(observedNode)
    };

    let renderBox = () => {
        let dataToRender = ""
        let visibleList = ""
        dataToRender+="<div style='height:"+ start*boxHeight +"px'></div>"
        for(i=start;i<=end;i++) {
            visibleList += '<p class="visible-boxes">'+i.toString()+'</p>'
            dataToRender += '<div class="box" id='+i+'><div class="inside-box"><p class="number-text">'+i+'</p></div></div>'
        }
        dataToRender+="<div style='height:"+ (totalNumberOfBox-end)*boxHeight +"px'></div>"
        document.getElementById("container").innerHTML +=dataToRender
        document.getElementById("result").innerHTML += visibleList
        addObserver(Math.round((end+start)/2))
    };

    let initialiseValues= (totalNumberOfBox) => {
        start=0
        end = Math.ceil(containerHeight/boxHeight)
        renderBox()
    }
    initialiseValues(totalNumberOfBox)
</script>
</html>